<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Rozette</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="main.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="https://code.responsivevoice.org/responsivevoice.js"></script>
</head>

<body>
    <div class="container">
        <h1> How to Rozette</h1>
        <p> Deze tutorial legt stap voor stap uit hoe je een translate to speech pagina aanmaakt voor jouw organisatie.</p>
        <h2> Stap 1: Voor we beginnen</h2>
        <p> <a href="https://accounts.google.com/SignUpWithoutGmail?hl=nl" target="_blank">Maak een google account aan</a> als je er nog geen hebt.</p>
        <h2> Stap 2: Maak een kopie van onze spreadsheet</h2>
        <p> Ga naar <a href="https://docs.google.com/spreadsheets/d/1gObKbzXTj_wlsWVmx2DMCOzJ5LQ3aqxIqyq2h7DNuHg" target="_blank" >deze google spreadsheet </a></p>
        <p> Klik op "Bestand" en vervolgens op "Een kopie maken..." </p>
        <p> Nu kan je de naam aanpassen. Klik daarna op "OK". Vervolgens wordt de spreadsheet aangemaakt en geopend.</p>
        <iframe src="gifs/duplicateSheet.gif" width="565" height="329" scrolling="no"></iframe>
        <p> Om de data van de spreadsheet publiek te maken klik op "bestand" en vervolgens op "publiceren op internet..." </p>
        <iframe src="gifs/publicizeSheet.gif" width="565" height="329" scrolling="no"></iframe>
        <h2> Stap 3: Maak een kopie van het script</h2>
        <p> Klik op "Extra" en vervolgens "Scripteditor...".</p>
        <p> Klik op "Bestand" en vervolgens op "Een kopie maken...".</p>
        <iframe src="gifs/duplicateScript.gif" width="565" height="329" scrolling="no"></iframe>
        <p> Klik daarna op "Uitvoeren" en dan "Functie uitvoeren > updateSheet".</p>
        <p> Wacht even tot wanneer de melding "Autorisatie vereist" verschijnt en klik dan op "Rechten bekijken".</p>
        <p> Selecteer uw google drive account.</p>
        <p> Klik op "Geavanceerd", dan op "Ga naar (...)" en tenslotte op "Toestaan"</p>
        <iframe src="gifs/authorizeScript.gif" width="565" height="329" scrolling="no"></iframe>
        <h2> Stap 4: Pas uw spreadsheet aan</h2>
        <ol>
            <li>Voeg te vertalen termen/zinnen toe in de meest linkse kolom</li>
            <li>Voeg de <a href="https://nl.wikipedia.org/wiki/ISO_3166-1" target="_blank">2-letterige landcodes</a> van de talen* naar waar u wenst te vertalen toe als kolomtitels</li>
        </ol>
        <img src="images/translate_tabel.PNG" width="918" height="186">
        <p> Het gekoppeld script doet de rest voor u. Sit back and relax terwijl de spreadsheet gegenereerd wordt. </p>
        <span> *: niet alle talen worden ondersteund. <a href="https://responsivevoice.org/text-to-speech-languages/" target="_blank">Klik hier</a> voor een overzicht. </span>
        <h2> Stap 5: Genereer uw eigen Rozette pagina </h2>
        <p> KopiÃ«er de url van uw eigen spreadsheet en geef ze hier in om uw eigen pagina te genereren:</p>
        
        <form name="getSheet">
            Spreadsheet url:
            <input id="sheetUrl" type="text" name="sheet">
            <input type="button" value="Maak Rozette pagina" onclick="redirect()">
        </form>
        <p> Vervolgens zal u naar de hoofdpagina herleid worden van Rozette</p>
        <p> Om de volgende keer terug deze pagina te bezoeken raden wij aan om deze url ergens op te slaan bij uw favorieten.</p>
        <p> Klik op het "sterretje" om de website die nu open staat bij uw favorieten toe te voegen.</p>
        <img src="images/url_rozette.PNG" width="800" height="145">
    </div>
</body>

<script>
    function redirect() {
        var sheetUrl = document.getElementById("sheetUrl").value;
        var sheetId = ((sheetUrl.split("spreadsheets/d/"))[1].split("/"))[0];
        var pathArray = location.href.split( '/' );
        var protocol = pathArray[0];
        var host = pathArray[2];
        var url = protocol + '//' + host + "/Rozette/?sheet=" + sheetId;
        console.log(url);
        window.location.href=url;
    }
</script>
